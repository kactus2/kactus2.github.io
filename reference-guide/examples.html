<!-- HTML header for doxygen 1.13.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Kactus2: Kactus2 scripting examples</title>
<link rel="icon" href="appicon.ico" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="doxygen-awesome-darkmode-toggle.js"></script>
<script type="text/javascript">
    DoxygenAwesomeDarkModeToggle.init()
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="appicon.png"/></td>
  <td id="projectalign">
   <div id="projectname">Kactus2
   </div>
   <div id="projectbrief">Kactus2 reference guide</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('examples.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Kactus2 scripting examples</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#autotoc_md3">Setting up IP-XACT libraries</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md4">Creating a component</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md5">Creating a design and adding a component instance</a>
  </li>
  <li class="level1">
    <a href="#autotoc_md6">Modifying components</a>
    <ul>
      <li class="level2">
        <a href="#autotoc_md7">Modifying component memory maps</a>
        <ul>
          <li class="level3">
            <a href="#autotoc_md8">Creating a memory map</a>
          </li>
          <li class="level3">
            <a href="#autotoc_md9">Adding address blocks</a>
          </li>
          <li class="level3">
            <a href="#autotoc_md10">Adding registers and fields</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#autotoc_md11">Modifying component bus interfaces</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md12">Practical example: Getting physical ports used in bus interface</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="anchor" id="md_kactus2dev_2Administrative_2docs_2Python-examples"></a></p>
<p>Here are some simple examples on how to use Kactus2 via Python scripting.</p>
<dl class="section note"><dt>Note</dt><dd>After running scripts in GUI, changes made to documents (components, designs) won't be visible until the document is refreshed in the GUI.</dd></dl>
<h1><a class="anchor" id="autotoc_md3"></a>
Setting up IP-XACT libraries</h1>
<p>IP-XACT libraries can be set either in the GUI or via Python. Currently configured library paths can be listed with <a class="el" href="classPythonAPI.html#acb230e230fb19cd7c5f2e6926d501aa2">PythonAPI::getAllLibraryPaths</a> or <a class="el" href="classPythonAPI.html#a50d51ea8915f74240807252e04d8b138">PythonAPI::getActiveLibraryPaths</a>, and <a class="el" href="classPythonAPI.html#ae44840299315dc3c5a8f1cb2415bd880">PythonAPI::getDefaultLibraryPath</a> (for the current default), e.g.; </p><div class="fragment"><div class="line"><span class="keyword">from</span> pythonAPI <span class="keyword">import</span> PythonAPI</div>
<div class="line"> </div>
<div class="line">kactus2py = <a class="code hl_class" href="classPythonAPI.html">PythonAPI</a>()</div>
<div class="line">print(kactus2py.getAllLibraryPaths()) <span class="comment"># Lists all configured paths</span></div>
<div class="line">print(kactus2py.getActiveLibraryPaths()) <span class="comment"># Lists paths currently set active = where Kactus2 looks for IP-XACT files </span></div>
<div class="line">print(kactus2py.getDefaultLibraryPath()) <span class="comment"># Lists the current default library path</span></div>
<div class="ttc" id="aclassPythonAPI_html"><div class="ttname"><a href="classPythonAPI.html">PythonAPI</a></div><div class="ttdoc">Interface for accessing Kactus2 data using Python.</div><div class="ttdef"><b>Definition</b> <a href="PythonAPI_8h_source.html#l00065">PythonAPI.h:66</a></div></div>
</div><!-- fragment --><p>Libraries can be added with <a class="el" href="classPythonAPI.html#aa3766d815d8802b9d5814906971be982">PythonAPI::addLibraryPath</a> and removed with <a class="el" href="classPythonAPI.html#a27ef686e76a114dce39a82a10b916d72">PythonAPI::removeLibraryPath</a>. Libraries can be set in bulk with <a class="el" href="classPythonAPI.html#a9cebaa2f0bc167dda6d2ef099fdc26e2">PythonAPI::setLibraryPaths</a>, which will add and set active all paths that are given as a list in the function arguments. <a class="el" href="classPythonAPI.html#a5ebc69a0b48d778313617eaddc8f17b7">PythonAPI::setDefaultLibraryPath</a> sets the default location.</p>
<div class="fragment"><div class="line">kactus2py.addLibraryPath(<span class="stringliteral">&quot;C:/some/path&quot;</span>, <span class="keyword">False</span>) <span class="comment"># optional second argument sets active (True) or inactive (False), active by default</span></div>
<div class="line">kactus2py.setDefaultLibraryPath(<span class="stringliteral">&quot;C:/some/path&quot;</span>)</div>
<div class="line">kactus2py.setLibraryPathActive(<span class="stringliteral">&quot;C:/some/path&quot;</span>, <span class="keyword">True</span>) <span class="comment"># set the earlier path active</span></div>
<div class="line">...</div>
<div class="line">kactus2py.setLibraryPaths([<span class="stringliteral">&#39;C:/some/new/path&#39;</span>, <span class="stringliteral">&#39;C:/another/new/path&#39;</span>]) <span class="comment"># Replaces the active library paths and also sets the first listed path as default</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Creating a component</h1>
<p>Creating a component is done with <a class="el" href="classPythonAPI.html#a5bbd8d89317a50ed9000692321229b77">PythonAPI::createComponent</a>. As parameters, it takes the VLNV (vendor, library, name, version) of the component to be created, one parameter each, and the IP-XACT standard revision to use (<a class="el" href="classPythonAPI.html#adf9f13e5c7a7070c1055c81c16b8918d">PythonAPI::StdRev</a>). Example:</p>
<div class="fragment"><div class="line"><span class="comment"># Create component with VLNV Company:Lib:ComponentName:1.0 using IP-XACT 2014</span></div>
<div class="line">vendor = <span class="stringliteral">&quot;Company&quot;</span></div>
<div class="line">library = <span class="stringliteral">&quot;Lib&quot;</span></div>
<div class="line">name = <span class="stringliteral">&quot;ComponentName&quot;</span></div>
<div class="line">version = <span class="stringliteral">&quot;1.0&quot;</span></div>
<div class="line"> </div>
<div class="line">kactus2py.createComponent(vendor, library, name, version, kactus2py.Std14)</div>
</div><!-- fragment --><p>The created component will be placed in the <b>default library path</b>.</p>
<dl class="section note"><dt>Note</dt><dd>Supported standard revisions are Std14 and Std22 and the default value is Std22.</dd></dl>
<p>The IP-XACT standard revision of a component can be checked with <a class="el" href="classPythonAPI.html#a971ae423fd36c159f904893330da0d58">PythonAPI::getComponentStdRevision</a> : </p><div class="fragment"><div class="line">revision = kactus2py.getComponentStdRevision() <span class="comment"># Returns &quot;1685-2014&quot; in this case</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md5"></a>
Creating a design and adding a component instance</h1>
<p>Similarly to creating components, a design can be created with <a class="el" href="classPythonAPI.html#adfbbacd7b681629a5465d19ae09b148c">PythonAPI::createDesign</a>:</p>
<div class="fragment"><div class="line">designName = <span class="stringliteral">&quot;AwesomeDesign&quot;</span></div>
<div class="line">designVersion = <span class="stringliteral">&quot;1.0&quot;</span></div>
<div class="line"> </div>
<div class="line">kactus2py.createDesign(vendor, library, designName, designVersion, kactus2py.Std14)</div>
</div><!-- fragment --><p>The IP-XACT standard revision of a design can also be checked with <a class="el" href="classPythonAPI.html#a76e6dbc579a6f7aa03646610abbedeb3">PythonAPI::getDesignStdRevision</a>.</p>
<p>Creating a design will create 1) The design itself and 2) A top-level component for the design. The top-level component VLNV will become vendor:library:name:version and the design VLNV will become vendor:library:name.design:version. The design will be created in the default library.</p>
<p>The component can then be instantiated and added to the design. Creating a design will automatically set it as active, but in any other case the design must be set active with <a class="el" href="classPythonAPI.html#afae64475954faa45d272b75c0a67de88">PythonAPI::openDesign</a>, which takes the design VLNV as a vlnvString (vendor:library:name:version).</p>
<p>The component can be instantiated and added to the design with <a class="el" href="classPythonAPI.html#ab151e5e284a634dce73427d924439f27">PythonAPI::addComponentInstance</a>, which also takes a vlnvstring and the instance name:</p>
<div class="fragment"><div class="line">kactus2py.openDesign(<span class="stringliteral">&quot;:&quot;</span>.join([vendor, library, designName + <span class="stringliteral">&quot;.design&quot;</span>, designVersion]))</div>
<div class="line">kactus2py.addComponentInstance(<span class="stringliteral">&quot;:&quot;</span>.join([vendor, library, name, version]), <span class="stringliteral">&quot;NewInstance&quot;</span>)</div>
</div><!-- fragment --><p>Changes to a design are saved with <a class="el" href="classPythonAPI.html#af0fcb19712c24cdf37800ce5ba7e2408">PythonAPI::saveDesign</a>, which will write the changes to disk. The currently open design can be closed with <a class="el" href="classPythonAPI.html#ae26eb7a85b03b5ba8a04565c9ea712b2">PythonAPI::closeOpenDesign</a>:</p>
<div class="fragment"><div class="line">kactus2py.saveDesign()</div>
<div class="line">kactus2py.closeOpenDesign()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md6"></a>
Modifying components</h1>
<p>Modifying a component requires that the component is opened first: </p><div class="fragment"><div class="line">kactus2py.openComponent(<span class="stringliteral">&quot;:&quot;</span>.join([vendor, library, name, version])) <span class="comment"># open Company:Lib:ComponentName:1.0</span></div>
</div><!-- fragment --><p>Now any changes made will be made to the opened component.</p>
<dl class="section note"><dt>Note</dt><dd>The following code examples generally don't include any error checks. Most setters return a boolean value, which can be used for detecting errors.</dd></dl>
<h2><a class="anchor" id="autotoc_md7"></a>
Modifying component memory maps</h2>
<p>Any modifications to component memory maps are made through KactusAPI interfaces. Memory maps can be modified via <a class="el" href="classMemoryMapInterface.html" title="Interface for editing memory maps and remaps.">MemoryMapInterface</a>, and it can be accessed with <a class="el" href="classPythonAPI.html#af831bbb58fedfc05f534b6eb3fe93013">PythonAPI::getMapInterface</a>. Address blocks, registers and fields can be modified in a similar way.</p>
<h3><a class="anchor" id="autotoc_md8"></a>
Creating a memory map</h3>
<p>A new map can be added with <a class="el" href="classMemoryMapInterface.html#a6f912e1f621733b7688b87e5cd9bcbce">MemoryMapInterface::addMemoryMap</a>. It takes an index as first parameter and the name as the second parameter. The index can be in the range [0, number of memory maps in the component], the easiest thing to do is always use index 0.</p>
<div class="fragment"><div class="line">mapInterface = kactus2py.getMapInterface()</div>
<div class="line">mapInterface.addMemoryMap(0, <span class="stringliteral">&quot;NewMemoryMap&quot;</span>)</div>
</div><!-- fragment --><p>The memory map can then be modified with the different functions of <a class="el" href="classMemoryMapInterface.html" title="Interface for editing memory maps and remaps.">MemoryMapInterface</a>, e.g. to set the address unit bits: </p><div class="fragment"><div class="line">mapAubOk = mapInterface.setAddressUnitBits(<span class="stringliteral">&quot;NewMemoryMap&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>) <span class="comment"># returns True, if operation was successful, otherwise False</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md9"></a>
Adding address blocks</h3>
<p>The address block interface can be accessed with <a class="el" href="classMemoryMapInterface.html#a3de8a2e844f178aa8e4fddb84e59800d">MemoryMapInterface::getAddressBlockInterface</a>. The interface must first be pointed to the memory map whose address blocks are to be edited: </p><div class="fragment"><div class="line">kactus2py.setBlocksForInterface(<span class="stringliteral">&quot;NewMemoryMap&quot;</span>)</div>
<div class="line">blockInterface = mapInterface.getAddressBlockInterface()</div>
</div><!-- fragment --><p>A new address block can be added with <a class="el" href="classAddressBlockInterface.html#aade4812ff60db047d542ee869aa87118">AddressBlockInterface::addBlock</a>. Its properties can be accessed in the same way as with memory maps: </p><div class="fragment"><div class="line">blockInterface.addBlock(0, <span class="stringliteral">&quot;NewAddressBlock&quot;</span>)</div>
<div class="line">widthOk = blockInterface.setWidth(<span class="stringliteral">&quot;NewAddressBlock&quot;</span>, <span class="stringliteral">&quot;32&quot;</span>)</div>
<div class="line">...</div>
<div class="line">blockInterface.getWidth(<span class="stringliteral">&quot;NewAddressBlock&quot;</span>) <span class="comment"># returns &quot;32&quot;</span></div>
</div><!-- fragment --><h3><a class="anchor" id="autotoc_md10"></a>
Adding registers and fields</h3>
<p>Register and field interfaces are accessed through <a class="el" href="classAddressBlockInterface.html#a093cbc8b2ce57d78b997a6f03a8fb4c2">AddressBlockInterface::getSubInterface</a> and <a class="el" href="classRegisterInterface.html#aee07847197780e14a27c0211469c8f07">RegisterInterface::getSubInterface</a> respectively. Apart from that they work as the previous interfaces. First, the available registers (the registers of the created address block) must be set for the register interface:</p>
<div class="fragment"><div class="line">kactus2py.setRegistersForInterface(<span class="stringliteral">&quot;NewMemoryMap&quot;</span>, <span class="stringliteral">&quot;NewAddressBlock&quot;</span>)</div>
<div class="line">regInterface = blockInterface.getSubInterface()</div>
</div><!-- fragment --><p>Then the register properties can be manipulated: </p><div class="fragment"><div class="line">regInterface.addRegister(0, 0, <span class="stringliteral">&quot;NewRegister&quot;</span>)</div>
<div class="line">regInterface.setSize(<span class="stringliteral">&quot;NewRegister&quot;</span>, <span class="stringliteral">&quot;16&quot;</span>)</div>
</div><!-- fragment --><p>Field editing is done in a similar fashion. First, the available fields must be set for the interface: </p><div class="fragment"><div class="line">kactus2py.setFieldsForInterface(<span class="stringliteral">&quot;NewMemoryMap&quot;</span>, <span class="stringliteral">&quot;NewAddressBlock&quot;</span>, <span class="stringliteral">&quot;NewRegister&quot;</span>) <span class="comment"># now editing fields of &quot;NewRegister&quot;</span></div>
</div><!-- fragment --><p>After that fields can be edited through the field interface: </p><div class="fragment"><div class="line">fieldInterface = regInterface.getSubInterface()</div>
<div class="line">fieldInterface.addField(0, <span class="stringliteral">&quot;NewField&quot;</span>)</div>
<div class="line">newWidthOk = fieldInterface.setWidth(<span class="stringliteral">&quot;NewField&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>) <span class="comment"># most setters return a boolean value for checking if operation was successful</span></div>
<div class="line">widthNotOk = fieldInterface.setWidth(<span class="stringliteral">&quot;non-existing-field&quot;</span>, <span class="stringliteral">&quot;8&quot;</span>) <span class="comment"># this would return false in this example</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md11"></a>
Modifying component bus interfaces</h2>
<p>The components bus interfaces are directly accessible through the <a class="el" href="classBusInterfaceInterface.html" title="Interface for accessing bus interfaces.">BusInterfaceInterface</a> class, after <a class="el" href="classPythonAPI.html#a311926338ac81d14db6e87ed1b5ebeda">PythonAPI::openComponent</a> has been called.</p>
<p>In this example, we'll first create some ports for our component. Then, we'll create a bus interface and some portmaps for it. For mapping ports, we need a bus- and abstraction definition, which cannot be created via the python API, but can be created in the GUI.</p>
<p>The bus definition created for this example is not modified in any way and its VLNV is Company:Lib:TestBus:1.0. The abstraction defintion is Company:Lib:TestBus.absDef:1.0. Here's the abstraction definition used: <img src="testAbsDef.png" alt="" class="inline" title="Example abstraction definition"/>    </p>
<p>Let's start by creating the physical component ports: </p><div class="fragment"><div class="line">portsInterface = kactus2py.getPortsInterface()</div>
<div class="line">portsInterface.addWirePort(<span class="stringliteral">&quot;some_rx&quot;</span>)</div>
<div class="line">portsInterface.setDirection(<span class="stringliteral">&quot;some_rx&quot;</span>, <span class="stringliteral">&quot;in&quot;</span>)</div>
<div class="line">portsInterface.setWidth(<span class="stringliteral">&quot;some_rx&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>)</div>
<div class="line"> </div>
<div class="line">portsInterface.addWirePort(<span class="stringliteral">&quot;some_tx&quot;</span>)</div>
<div class="line">portsInterface.setDirection(<span class="stringliteral">&quot;some_tx&quot;</span>, <span class="stringliteral">&quot;out&quot;</span>)</div>
<div class="line">portsInterface.setWidth(<span class="stringliteral">&quot;some_tx&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Let&#39;s add some unmapped ports as well</span></div>
<div class="line">portsInterface.addWirePort(<span class="stringliteral">&quot;otherPort1&quot;</span>)</div>
<div class="line">portsInterface.setDirection(<span class="stringliteral">&quot;otherPort1&quot;</span>, <span class="stringliteral">&quot;inout&quot;</span>)</div>
<div class="line">portsInterface.addWirePort(<span class="stringliteral">&quot;otherPort2&quot;</span>)</div>
<div class="line">portsInterface.setDirection(<span class="stringliteral">&quot;otherPort2&quot;</span>, <span class="stringliteral">&quot;inout&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Not setting any port bounds results in the port having width 1, which we want in this case</span></div>
</div><!-- fragment --><p>Now, let's create the bus interface: </p><div class="fragment"><div class="line">busInterfaceInterface = kactus2py.getBusInterface() <span class="comment"># gets the BusInterfaceInterface object</span></div>
<div class="line">busInterfaceInterface.addBusInterface(0, <span class="stringliteral">&quot;NewBusInterface&quot;</span>) <span class="comment"># Index doesn&#39;t really matter, as bus interfaces (should) have unique names</span></div>
<div class="line">busInterfaceInterface.setMode(<span class="stringliteral">&quot;NewBusInterface&quot;</span>, <span class="stringliteral">&quot;master&quot;</span>)</div>
</div><!-- fragment --><p>Before creating portmaps, the bus interface needs a bus type and at least one abstraction type. These are references to the bus definition and abstraction definition. In this example we'll use Company:Lib:TestBus:1.0 and Company:Lib:TestBus.absDef:1.0 :</p>
<div class="fragment"><div class="line">busInterfaceInterface.setupSubInterfaces(<span class="stringliteral">&quot;NewBusInterface&quot;</span>) <span class="comment"># prepare subinterfaces for use</span></div>
<div class="line">busInterfaceInterface.setBusType(<span class="stringliteral">&quot;NewBusInterface&quot;</span>, <span class="stringliteral">&quot;Company&quot;</span>, <span class="stringliteral">&quot;Lib&quot;</span>, <span class="stringliteral">&quot;TestBus&quot;</span>, <span class="stringliteral">&quot;1.0&quot;</span>)</div>
<div class="line">busInterfaceInterface.addAbstractionType(<span class="stringliteral">&quot;NewBusInterface&quot;</span>, <span class="stringliteral">&quot;Company&quot;</span>, <span class="stringliteral">&quot;Lib&quot;</span>, <span class="stringliteral">&quot;TestBus.absDef&quot;</span>, <span class="stringliteral">&quot;1.0&quot;</span>)</div>
</div><!-- fragment --><p>Then, let's setup the portmaps. We'll simply map the logical "some_rx" to physical and the same with "some_tx". First, we need to setup the <a class="el" href="classAbstractionTypeInterface.html" title="Interface for accessing abstraction types.">AbstractionTypeInterface</a>, through which portmaps can be accessed. Abstraction types and portmaps don't have names, so indices are used to select the wanted abstraction type or portmap:</p>
<div class="fragment"><div class="line">abstractionInterface = busInterfaceInterface.getAbstractionTypeInterface()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Map only master mode ports with this master mode bus interface:</span></div>
<div class="line">abstractionInterface.setBusMode(<span class="stringliteral">&quot;master&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Setup portmaps and abstraction definition reference for wanted abstraction type. </span></div>
<div class="line"><span class="comment"># Ours is the first so it&#39;s found with index 0. Available abstraction types can be listed in the order of their index with AbstractionTypeInterface::getItemNames.</span></div>
<div class="line">abstractionInterface.setupAbstractionTypeForPortMapInterface(0)</div>
<div class="line"> </div>
<div class="line">portMapInterface = abstractionInterface.getPortMapInterface()</div>
<div class="line"> </div>
<div class="line"><span class="comment"># We need two port mappings: one for some_tx and one for some_rx</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># The new portmap should be added to the end of the portmap list so that indices don&#39;t get messed up (though in this case it is just 0)</span></div>
<div class="line">newPortMapIndex = portMapInterface.itemCount()</div>
<div class="line">portMapInterface.addPortMap(newPortMapIndex)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Map some_tx</span></div>
<div class="line">portMapInterface.setLogicalPort(newPortMapIndex, <span class="stringliteral">&quot;some_tx&quot;</span>) <span class="comment"># here &quot;some_tx&quot; refers to the logical port name set in the abstraction definition</span></div>
<div class="line">portMapInterface.setPhysicalPort(newPortMapIndex, <span class="stringliteral">&quot;some_tx&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Add new port mapping for some_rx</span></div>
<div class="line">newPortMapIndex = portMapInterface.itemCount()</div>
<div class="line">portMapInterface.addPortMap(newPortMapIndex)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># Map some_rx</span></div>
<div class="line">portMapInterface.setLogicalPort(newPortMapIndex, <span class="stringliteral">&quot;some_rx&quot;</span>)</div>
<div class="line">portMapInterface.setPhysicalPort(newPortMapIndex, <span class="stringliteral">&quot;some_rx&quot;</span>)</div>
<div class="line"> </div>
<div class="line"><span class="comment"># If no port mapping bounds are set, then the whole logical and physical ports will be used.</span></div>
</div><!-- fragment --><p>Resulting ports shown in GUI after running script: <img src="result_ports.png" alt="" class="inline" title="Created ports"/>    </p>
<p>The created bus interface: <img src="result_bus.png" alt="" class="inline" title="Created bus interface"/>    </p>
<p>And the portmaps: <img src="result_portmaps.png" alt="" class="inline" title="Created portmaps"/>    </p>
<h2><a class="anchor" id="autotoc_md12"></a>
Practical example: Getting physical ports used in bus interface</h2>
<p>Assuming we have a component with a bus interface with portmaps (like in the previous example), to print information of the physical ports a bus interface is using, we can do the following:</p>
<div class="fragment"><div class="line"><span class="comment"># Assume component has already been opened, and the component has the bus interface &quot;NewBusInterface&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment"># Set up the sub-interfaces</span></div>
<div class="line">busInterfaceInterface = kactus2py.getBusInterface()</div>
<div class="line">busInterfaceInterface.setupSubInterfaces(<span class="stringliteral">&quot;NewBusInterface&quot;</span>)</div>
<div class="line">abstractionInterface = busInterfaceInterface.getAbstractionTypeInterface()</div>
<div class="line">abstractionInterface.setupAbstractionTypeForPortMapInterface(0)</div>
<div class="line">portMapInterface = abstractionInterface.getPortMapInterface()</div>
<div class="line"> </div>
<div class="line">numPortMaps = portMapInterface.itemCount()</div>
<div class="line">foundPorts = []</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, numPortMaps):</div>
<div class="line">    currentPhysical = portMapInterface.getPhysicalPortName()</div>
<div class="line">    print(currentPhysical)</div>
<div class="line">    foundPorts.append(currentPhysical)</div>
</div><!-- fragment --><p>Then the individual ports can be accessed with KactusAPI::PortsInterface: </p><div class="fragment"><div class="line">portsInterface = kactus2py.getPortsInterface()</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(0, numPortMaps):</div>
<div class="line">    print(portsInterface.getWidth(foundPorts[i]))</div>
</div><!-- fragment --><p> With the previous example, the above should print </p><div class="fragment"><div class="line">some_tx</div>
<div class="line">1</div>
<div class="line">some_rx</div>
<div class="line">1</div>
</div><!-- fragment --><p>Notice how the previously added extra ports <code>otherPort1</code> and <code>otherPort2</code> don't show up, because they weren't mapped to any logical signals. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
